<!DOCTYPE html>
<html>
<head>
    <title>Game Data Editor</title>
    <script>
        const apiURL = 'https://u8der8ty5g.execute-api.us-east-1.amazonaws.com/dev/ReadWriteDDB';
        const tableName = 'LiveUpdate'; // Add your DynamoDB table name here

        async function loadData() {
    try {
        const response = await fetch(`${apiURL}?TableName=${tableName}`);
        const data = await response.json();

        // Log the data to see what's actually being returned
        console.log(data);

        // Check if data contains items and handle accordingly
        if (data && Array.isArray(data) && data.length > 0) {
            const item = data[0];
            document.getElementById('promptInput').value = item.prompt || '';
            document.getElementById('audienceMessageInput').value = item.audienceMessage || '';
            document.getElementById('spriteLinkInput').value = item.spriteLink || '';
        } else {
            console.log('No items returned from the database.');
            // Handle case where no items are found - maybe clear the input fields or show a message
            document.getElementById('promptInput').value = '';
            document.getElementById('audienceMessageInput').value = '';
            document.getElementById('spriteLinkInput').value = '';
        }
    } catch (error) {
        console.error('Error loading data:', error);
    }
}

        async function updateData() {
    try {
        // Generate a unique updateId based on the current timestamp
        const updateId = `update-${new Date().toISOString()}`;

        const newData = {
            TableName: 'UpdateLive',
            Item: {
                updateId: updateId, // Use the generated unique identifier
                prompt: document.getElementById('promptInput').value,
                audienceMessage: document.getElementById('audienceMessageInput').value,
                spriteLink: document.getElementById('spriteLinkInput').value
            }
        };

        await fetch(apiURL, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(newData)
        });

        alert('Data updated successfully');
        loadData(); // Reload data after update
    } catch (error) {
        console.error('Error updating data:', error);
    }
}

        window.onload = loadData;
    </script>
</head>
<body>
    <h1>Game Data Editor</h1>
    <div>
        <label for="promptInput">Prompt:</label><br>
        <input type="text" id="promptInput" name="prompt"><br>

        <label for="audienceMessageInput">Audience Message:</label><br>
        <input type="text" id="audienceMessageInput" name="audienceMessage"><br>

        <label for="spriteLinkInput">Sprite Link:</label><br>
        <input type="text" id="spriteLinkInput" name="spriteLink"><br><br>

        <button onclick="updateData()">Update Game Data</button>
    </div>
</body>
</html>
